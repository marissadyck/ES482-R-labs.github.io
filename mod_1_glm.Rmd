---
title: "Statistical Modeling"
author: 'Module 1: General and generalized linear models (GLMs)'
date: "2024"
output:
  html_document:
    code_folding: show
    theme: journal
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE,
	cache = TRUE
)
```

```{r echo = FALSE, message=FALSE, warning=FALSE}

#  ES482 R labs   
#      University of Victoria, Victoria BC Canada             

#  Statistical Modeling
# Module 1: General and generalized linear models (GLMs)


```

## Materials

### Scripts

1. Click [here](mod_1_glm.R) to download the script! Save the script to the 'scripts'' folder in your project directory you set up in the previous module.

2. Load your script in RStudio. To do this, open RStudio and click the **files** window and select the scripts folder and then this script.

### Cheat sheets

There are no cheat sheets specific to this module but don't forget the ones you've already printed for previous modules!

## Basics of a GLM

A Generalized liner model (GLM) is a variation on a linear regression which allows the response variable to have a distribution other than the normal (Gaussian) distribution.

### Steps of GLM

When applying a generalized linear model to your data follow the steps below    

1. Choose the most appropriate distribution for the response variable. e.g., Gaussian, Poisson, negative binomial, gamma, binomial, etc.   

2. Define the systematic component in terms of explanatory variables. 

3. Specify the link between the mean of the response variable and the systematic part.    

4. Check model assumptions.      


## Distributions
Common non-normal distributions for wildlife data include...

### Binomial distribution

The binomial distribution represents the probability of an outcome given only two options (e.g. 0s and 1s). Presence/absence data from remote camera traps is a great example of this.

![](images/binomial-distribution-formula.png)

### Poisson distribution

The poisson distribution represents how many times an event is likely to occur over a specified period. Count data follow the poisson distribution.

![](images/poisson-distribution-formula.png)

### Negative binomial distribution


### Which distribution to use?

Here is a helpful table from [Thiele and Markussen 2012](https://www.cabidigitallibrary.org/doi/abs/10.1079/PAVSNNR20127016) you can use to determine which distribution you should use with your data. 

![](images/glm_distributions.png)

## Assumptions of GLM


The data 
 are independently distributed, i.e., cases are independent.
The dependent variable 
 does NOT need to be normally distributed, but it typically assumes a distribution from an exponential family (e.g. binomial, Poisson, multinomial, normal, etc.).
A GLM does NOT assume a linear relationship between the response variable and the explanatory variables, but it does assume a linear relationship between the transformed expected response in terms of the link function and the explanatory variables; e.g., for binary logistic regression 
.
Explanatory variables can be nonlinear transformations of some original variables.
The homogeneity of variance does NOT need to be satisfied. In fact, it is not even possible in many cases given the model structure.
Errors need to be independent but NOT normally distributed.
Parameter estimation uses maximum likelihood estimation (MLE) rather than ordinary least squares (OLS).

<center>
![](images/construction_dog.jpeg){width=40%}
</center>